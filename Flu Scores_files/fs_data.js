/*
 ____   ___    _   _  ___ _____   _____ ____ ___ _____ 
|  _ \ / _ \  | \ | |/ _ \_   _| | ____|  _ \_ _|_   _|
| | | | | | | |  \| | | | || |   |  _| | | | | |  | |  
| |_| | |_| | | |\  | |_| || |   | |___| |_| | |  | |  
|____/ \___/  |_| \_|\___/ |_|   |_____|____/___| |_|  
                                                       
        Automatically generated from sources at:       
      https://github.com/cmu-delphi/www-fluscores      
*/



(function(){var e;("undefined"!=typeof exports&&null!==exports?exports:window).FS_Data=e=function(){function e(){}var t,n,r,s,a,o,i,l,u;return e.regions=function(){var e,t;for(t=[],r=e=0;e<=10;r=++e)t.push(0===r?"Nat":"Reg"+r);return t}(),e.regions_2015=function(){var e,t;for(t=[],r=e=0;e<=10;r=++e)t.push(0===r?"us":"region"+r);return t}(),e.hhsRegions=function(){var e,t;for(t=[],r=e=0;e<=10;r=++e)t.push(0===r?"nat":"hhs"+r);return t}(),e.targets_seasonal=["onset","peakweek","peak"],e.targets_seasonal_2015=["onset","pkwk","pkper"],e.targets_local=["1_week","2_week","3_week","4_week"],e.targets_local_2015=["1wk","2wk","3wk","4wk"],e.targets=e.targets_seasonal.concat(e.targets_local),e.targets_2015=e.targets_seasonal_2015.concat(e.targets_local_2015),e.errors=["LS","AE"],e.error_labels=["log score","absolute error"],e.wILI=null,e.init=function(e){var t,n,s,a,o,i,l,u,h;if(null===this.wILI){if(2014===e)this.epiweeks=function(){var e,t;for(t=[],r=e=1;e<=32;r=++e)t.push(""+(r<=13?201440+r:201500+r-13));return t}();else{if(2015!==e&&20150!==e)throw new Error("unsupported season: "+e);this.epiweeks=function(){var e,t;for(t=[],r=e=2;e<=30;r=++e)t.push(""+(r<=12?201540+r:201600+r-12));return t}()}for(t=function(e){return function(t,n){return function(r,s,a){var o,i,l,u,h,f,g,c,p;if(1!==r)return console.log("Epidata API [fluview, "+t+"] says: "+s);for(p=function(){var e,t,n;for(n=[],e=0,t=a.length;e<t;e++)g=a[e],n.push(g.wili);return n}(),h=[10,0],u=h[0],l=h[1],o=0,i=p.length;o<i;o++)c=p[o],f=[Math.min(u,c),Math.max(l,c)],u=f[0],l=f[1];return e.wILI[n]=function(){var e,t,n;for(n=[],e=0,t=p.length;e<t;e++)c=p[e],n.push((c-u)/(l-u));return n}()}}}(this),this.wILI={combine:[]},h=Epidata.range(this.epiweeks[0],this.epiweeks[this.epiweeks.length-1]),i=_.zip(this.hhsRegions,this.regions),u=[],s=0,a=i.length;s<a;s++)l=i[s],n=l[0],o=l[1],this.wILI[o]=[],u.push(Epidata.fluview(t(n,o),n,h));return u}},e.update=function(e,t,n,s,a,o){var i,l,u,h,f,g,c,p,v,w,d,k,m,x,I,b,A,F,N,y,E,L,R,z,T,O,S,$;for(T=null,L="combine"===s?this.targets:"seasonal"===s?this.targets_seasonal:"local"===s?this.targets_local:[s],F="combine"===a?this.regions:[a],20150===t&&(L=function(){var e,t,n;for(n=[],e=0,t=L.length;e<t;e++)E=L[e],n.push(this.targets_2015[this.targets.indexOf(E)]);return n}.call(this),F=function(){var e,t,n;for(n=[],e=0,t=F.length;e<t;e++)x=F[e],n.push(this.regions_2015[this.regions.indexOf(x)]);return n}.call(this)),w=F.length,d=L.length,z=function(){var t;t=[];for(E in e)t.push(E);return t}(),l=0,h=F.length;l<h;l++)for(x=F[l],u=0,f=L.length;u<f;u++){for(E=L[u],S=[],v=0,g=z.length;v<g;v++){for(R=z[v],N=[],I=this.epiweeks,k=0,c=I.length;k<c;k++)$=I[k],O=e[R][x][E][n][$],N.push(O/(w*d));S.push(N)}if(null===T)T=S;else for(b=_.zip(S,T),m=0,p=b.length;m<p;m++)for(A=b[m],y=A[0],i=A[1],r=0;r<i.length;)i[r]+=y[r],r++}return T},l=function(e){var t,n,r,s,a,o,i,l,u,h,f;for(t=[],u=e[0],s=0,o=u.length;s<o;s++)r=u[s],t.push(Array(e.length));for(l=a=0,h=e.length-1;0<=h?a<=h:a>=h;l=0<=h?++a:--a)for(n=i=0,f=e[0].length-1;0<=f?i<=f:i>=f;n=0<=f?++i:--i)t[n][l]=e[l][n];return t},e.addAllOptions=function(e,n,r){var s,a,o;return s={value:"combine",text:"[average of all]"},o={value:"seasonal",text:"[3 long-term]"},a={value:"local",text:"[4 short-term]"},t(e,this.errors,this.error_labels),t(n,this.targets,this.targets,[s,o,a]),t(r,this.regions,this.regions,[s])},t=function(e,t,n,r){var s,a,o,i,l,u,h,f,g,c;for(null==r&&(r=[]),a=0,i=r.length;a<i;a++)s=r[a],e.append($("<option/>",{value:s.value,text:s.text}));for(u=_.zip(t,n),f=[],o=0,l=u.length;o<l;o++)h=u[o],c=h[0],g=h[1],f.push(e.append($("<option/>",{value:c,text:g})));return f},e.loadFiles=function(e,t,n,r){var o,i,l,u,h,f,g;if(0===e.length)return r("no files selected");for(h=0,f=e.length;h<f;h++){if(l=e[h],!(2014!==t&&2015!==t||l.name.endsWith(".zip")))return r(l.name+" is not a zip file");if(20150===t&&!l.name.endsWith(".csv"))return r(l.name+" is not a csv file")}return u=0,i={},g=20150===t?s:a,o=function(t,s,a){var l;return null!=a?r(a):(i[t]=s,u<e.length?g(e[u++],o):n(function(){var e;e=[];for(l in i)e.push(l);return e}(),i))},g(e[u++],o)},a=function(t,r){var s;return s=new FileReader,s.onload=function(s){var a,o,i,l,h,f,g,c,p,v;v=new JSZip(s.target.result),a={},o=null;try{for(f=e.regions,l=0,h=f.length;l<h;l++)c=f[l],a[c]={},p=n(t.name,v,c,""),u(a[c],p,e.targets_seasonal),p=n(t.name,v,c,"_4wk"),u(a[c],p,e.targets_local)}catch(e){i=e,o=null!=(g=i.message)?g:""+i}return r(t.name,a,o)},s.readAsArrayBuffer(t)},u=function(t,n,s){var a,o,i,l,u,h;for(r=0,u=[],i=0,l=s.length;i<l;i++)h=s[i],t[h]={},u.push(function(){var s,i,l,u;for(l=e.errors,u=[],s=0,i=l.length;s<i;s++)a=l[s],t[h][a]={},u.push(function(){var s,i,l,u;for(l=e.epiweeks,u=[],i=0,s=l.length;i<s;i++)o=l[i],u.push(t[h][a][o]=n[r++]);return u}());return u}());return u},n=function(e,t,n,r){var s,a,i,l;a="^"+n+r+"_Team.*\\.csv$",i=new RegExp(a);for(s in t.files)if(i.test(s))return l=t.files[s].asText(),o(t.files[s].asText());throw{message:"/"+a+"/ not in "+e}},o=function(e){var t,n,r;return n=e.split("\n")[1].split(","),n.shift(),r=function(e){return Number.isNaN(e)?-10:e},function(){var e,s,a;for(a=[],e=0,s=n.length;e<s;e++)t=n[e],a.push(r(parseFloat(t)));return a}()},s=function(t,n){var r;return r=new FileReader,r.onload=function(r){var s,a,o,l,h,f,g,c,p,v,w,_,d,k;a={},o=null,s=r.target.result;try{for(p=e.regions_2015,h=0,g=p.length;h<g;h++)for(_=p[h],a[_]={},v=e.targets_2015,f=0,c=v.length;f<c;f++)d=v[f],k=i(s,_,d),u(a[_],k,[d])}catch(e){l=e,o=null!=(w=l.message)?w:""+l}return n(t.name,a,o)},r.readAsText(t)},i=function(e,t,n){var s,a,o,i,l,u,h,f,g,c,p,v,w;for(o=function(e){return Number.isNaN(e)?-10:e},p=[],s=[],g=e.split("\n").slice(1),i=0,u=g.length;i<u;i++)v=g[i],v=v.split(","),0!==v.length&&(h=v[1],w=v[2],f=v[7],h===t&&w===n&&(p.push(o(parseFloat(f))),9===v.length&&(a=v[8],s.push(o(parseFloat(a))))));if(0===s.length)for(r=l=0,c=p.length;0<=c?l<c:l>c;r=0<=c?++l:--l)p.push(0);else p=p.concat(s);return p},e}()}).call(this);